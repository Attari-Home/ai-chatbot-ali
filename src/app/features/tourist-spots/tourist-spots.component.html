<div class="tourist-spots-container">
  <!-- Header Section -->
  <div class="header-section">
    <div class="container mx-auto px-4 py-8">
      <h1 class="text-4xl font-bold text-gray-800 mb-4">UAE Tourist Attractions</h1>
      <p class="text-xl text-gray-600 max-w-3xl">
        Discover the most iconic and breathtaking destinations in the United Arab Emirates. 
        From architectural marvels to cultural landmarks, explore the wonders that make UAE a world-class destination.
      </p>
    </div>
  </div>

  <!-- Loading State -->
  <div *ngIf="loading" class="flex justify-center items-center py-20">
    <div class="animate-spin rounded-full h-16 w-16 border-b-2 border-blue-600"></div>
    <span class="ml-4 text-lg text-gray-600">Loading amazing destinations...</span>
  </div>

  <!-- Error State -->
  <div *ngIf="error" class="container mx-auto px-4 py-8">
    <div class="bg-red-50 border border-red-200 rounded-lg p-6 text-center">
      <div class="text-red-600 text-xl mb-2">‚ö†Ô∏è Error Loading Data</div>
      <p class="text-red-700">{{ error }}</p>
    </div>
  </div>

  <!-- Tourist Spots Grid -->
  <div *ngIf="!loading && !error" class="container mx-auto px-4 py-8">
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
      <div 
        *ngFor="let spot of touristSpots; trackBy: trackBySpotId"
        class="spot-card bg-white rounded-xl shadow-lg overflow-hidden transform transition-all duration-300 hover:scale-105 hover:shadow-xl cursor-pointer"
        (click)="selectSpot(spot)">
        
        <!-- Spot Image -->
        <div class="relative h-64 overflow-hidden">
          <img 
            [src]="(spot.images && spot.images.length > 0) ? spot.images[0].source_url : 'https://images.unsplash.com/photo-1512453979798-5ea266f8880c?w=400&h=300&fit=crop&crop=center'"
            [alt]="(spot.images && spot.images.length > 0) ? spot.images[0].alt_text : spot.name"
            class="w-full h-full object-cover"
            loading="lazy"
            (error)="onImageError($event)">
          <div class="absolute top-4 right-4 bg-blue-600 text-white px-3 py-1 rounded-full text-sm font-medium">
            {{ spot.emirate }}
          </div>
          <div class="absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/70 to-transparent p-4">
            <h3 class="text-xl font-bold text-white">{{ spot.name }}</h3>
          </div>
        </div>

        <!-- Spot Content -->
        <div class="p-6">
          <p class="text-gray-600 mb-4 line-clamp-3">{{ spot.short_summary }}</p>
          
          <!-- Tags -->
          <div class="flex flex-wrap gap-2 mb-4">
            <span 
              *ngFor="let tag of spot.tags.slice(0, 3)"
              class="px-2 py-1 bg-gray-100 text-gray-700 text-xs rounded-full">
              {{ tag }}
            </span>
            <span *ngIf="spot.tags.length > 3" class="px-2 py-1 bg-gray-200 text-gray-600 text-xs rounded-full">
              +{{ spot.tags.length - 3 }} more
            </span>
          </div>

          <!-- Rating and Actions -->
          <div class="flex justify-between items-center">
            <div class="flex items-center" *ngIf="spot.reviews">
              <div class="flex text-yellow-400 mr-2">
                <span *ngFor="let star of getStarArray(spot.reviews.average_rating)">
                  {{ star ? '‚òÖ' : '‚òÜ' }}
                </span>
              </div>
              <span class="text-sm text-gray-600">
                {{ spot.reviews.average_rating }}/5 ({{ spot.reviews.total_count }})
              </span>
            </div>
            <button class="text-blue-600 hover:text-blue-800 font-medium text-sm">
              Learn More ‚Üí
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Detailed Modal -->
  <div 
    *ngIf="selectedSpot" 
    class="fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50 p-4"
    (click)="closeModal()">
    
    <div 
      class="bg-white rounded-xl max-w-4xl max-h-[90vh] overflow-y-auto w-full relative"
      (click)="$event.stopPropagation()">
      
      <!-- Close Button -->
      <button 
        (click)="closeModal()"
        class="absolute top-4 right-4 z-10 bg-white rounded-full p-2 shadow-lg hover:bg-gray-100">
        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
        </svg>
      </button>

      <!-- Modal Header with Image -->
      <div class="relative h-80 overflow-hidden rounded-t-xl">
        <img 
          [src]="(selectedSpot.images && selectedSpot.images.length > 0) ? selectedSpot.images[0].source_url : 'https://images.unsplash.com/photo-1512453979798-5ea266f8880c?w=800&h=600&fit=crop&crop=center'"
          [alt]="(selectedSpot.images && selectedSpot.images.length > 0) ? selectedSpot.images[0].alt_text : selectedSpot.name"
          class="w-full h-full object-cover"
          (error)="onImageError($event)">
        <div class="absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/80 to-transparent p-6">
          <h2 class="text-3xl font-bold text-white mb-2">{{ selectedSpot.name }}</h2>
          <p class="text-white/90">üìç {{ selectedSpot.emirate }}, UAE</p>
        </div>
      </div>

      <!-- Modal Content -->
      <div class="p-6">
        <!-- Summary and Description -->
        <div class="mb-6">
          <p class="text-lg text-gray-700 mb-4">{{ selectedSpot.short_summary }}</p>
          <p class="text-gray-600 leading-relaxed">{{ selectedSpot.long_description }}</p>
        </div>

        <!-- Key Information Grid -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
          <!-- Practical Information -->
          <div class="bg-gray-50 rounded-lg p-4">
            <h3 class="font-semibold text-gray-800 mb-3">üïê Visit Information</h3>
            <div class="space-y-2 text-sm">
              <div><strong>Hours:</strong> {{ selectedSpot.opening_hours }}</div>
              <div><strong>Entry Fee:</strong> {{ selectedSpot.entry_fee }}</div>
              <div *ngIf="selectedSpot.practical_info?.estimated_visit_duration"><strong>Duration:</strong> {{ selectedSpot.practical_info!.estimated_visit_duration }}</div>
              <div><strong>Best Time:</strong> {{ selectedSpot.best_time_to_visit }}</div>
            </div>
          </div>

          <!-- Accessibility & Transport -->
          <div class="bg-gray-50 rounded-lg p-4">
            <h3 class="font-semibold text-gray-800 mb-3">üöó Getting There</h3>
            <div class="space-y-2 text-sm">
              <div><strong>Address:</strong> {{ selectedSpot.address }}</div>
              <div *ngIf="selectedSpot.practical_info?.parking"><strong>Parking:</strong> {{ selectedSpot.practical_info!.parking }}</div>
              <div *ngIf="selectedSpot.practical_info?.accessibility"><strong>Accessibility:</strong> {{ selectedSpot.practical_info!.accessibility }}</div>
              <div *ngIf="selectedSpot.practical_info?.public_transport && selectedSpot.practical_info!.public_transport.length > 0"><strong>Transport:</strong> {{ selectedSpot.practical_info!.public_transport.join(', ') }}</div>
            </div>
          </div>
        </div>

        <!-- Tags -->
        <div class="mb-6">
          <h3 class="font-semibold text-gray-800 mb-3">üè∑Ô∏è Categories</h3>
          <div class="flex flex-wrap gap-2">
            <span 
              *ngFor="let tag of selectedSpot.tags"
              class="px-3 py-1 bg-blue-100 text-blue-800 text-sm rounded-full">
              {{ tag }}
            </span>
          </div>
        </div>

        <!-- Nearby Attractions -->
        <div class="mb-6" *ngIf="selectedSpot.practical_info?.nearby_attractions && selectedSpot.practical_info!.nearby_attractions.length > 0">
          <h3 class="font-semibold text-gray-800 mb-3">üåü Nearby Attractions</h3>
          <div class="text-sm text-gray-600">
            {{ selectedSpot.practical_info!.nearby_attractions.join(' ‚Ä¢ ') }}
          </div>
        </div>

        <!-- Action Buttons -->
        <div class="flex flex-wrap gap-4">
          <button 
            (click)="openWebsite(selectedSpot.website)"
            class="px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors">
            üåê Visit Website
          </button>
          <button 
            (click)="openInMaps(selectedSpot.latitude, selectedSpot.longitude, selectedSpot.name)"
            class="px-6 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors">
            üó∫Ô∏è View on Maps
          </button>
        </div>

        <!-- Image Attribution -->
        <div class="mt-6 pt-4 border-t border-gray-200 text-xs text-gray-500" *ngIf="selectedSpot.images && selectedSpot.images.length > 0 && selectedSpot.images[0].attribution">
          üì∑ {{ selectedSpot.images[0].attribution }}
        </div>
      </div>
    </div>
  </div>
</div>
